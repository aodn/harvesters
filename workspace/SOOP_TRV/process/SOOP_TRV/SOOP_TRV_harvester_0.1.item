<?xml version="1.0" encoding="UTF-8"?>
<talendfile:ProcessType xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:talendfile="platform:/resource/org.talend.model/model/TalendFile.xsd" defaultContext="Default">
  <context confirmationNeeded="false" name="Default">
    <contextParameter comment="" name="logDir" prompt="logDir?" promptNeeded="false" repositoryContextId="_1TC3MFL9EeOUYeJDXGjB-Q" type="id_String" value="/tmp"/>
    <contextParameter comment="" name="paramFile" prompt="paramFile?" promptNeeded="false" repositoryContextId="_1TC3MFL9EeOUYeJDXGjB-Q" type="id_String" value="null"/>
    <contextParameter comment="" name="Destination_Database" prompt="Destination_Database?" promptNeeded="false" repositoryContextId="_Tq_7EAuXEeO-v4jR06LTxA" type="id_String" value="harvest"/>
    <contextParameter comment="" name="Destination_Login" prompt="Destination_Login?" promptNeeded="false" repositoryContextId="_Tq_7EAuXEeO-v4jR06LTxA" type="id_String" value="soop_trv"/>
    <contextParameter comment="" name="Destination_Password" prompt="Destination_Password?" promptNeeded="false" repositoryContextId="_Tq_7EAuXEeO-v4jR06LTxA" type="id_Password" value="XQPxICrOzqb096uhdGeE6g=="/>
    <contextParameter comment="" name="Destination_Port" prompt="Destination_Port?" promptNeeded="false" repositoryContextId="_Tq_7EAuXEeO-v4jR06LTxA" type="id_String" value="5432"/>
    <contextParameter comment="" name="Destination_Schema" prompt="Destination_Schema?" promptNeeded="false" repositoryContextId="_Tq_7EAuXEeO-v4jR06LTxA" type="id_String" value="soop_trv"/>
    <contextParameter comment="" name="Destination_Server" prompt="Destination_Server?" promptNeeded="false" repositoryContextId="_Tq_7EAuXEeO-v4jR06LTxA" type="id_String" value="localhost"/>
    <contextParameter comment="" name="exclude" prompt="exclude?" promptNeeded="false" repositoryContextId="_EMU5IED2EeO4PMQpaPeV8A" type="id_String" value="null"/>
    <contextParameter comment="" name="include" prompt="include?" promptNeeded="false" repositoryContextId="_EMU5IED2EeO4PMQpaPeV8A" type="id_String" value="&quot;.*\.nc$&quot;"/>
    <contextParameter comment="" name="sourceDir" prompt="sourceDir?" promptNeeded="false" repositoryContextId="_EMU5IED2EeO4PMQpaPeV8A" type="id_String" value="/media/Laurent_emII/IMOS_DATA/SOOP-TRV"/>
  </context>
  <parameters>
    <elementParameter field="TEXT" name="JOB_RUN_VM_ARGUMENTS" value=" -Xms256M -Xmx1024M"/>
    <elementParameter field="CHECK" name="JOB_RUN_VM_ARGUMENTS_OPTION" value="false"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_X" value="0"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_Y" value="0"/>
    <elementParameter field="TEXT" name="SCHEMA_OPTIONS" value="none"/>
    <elementParameter field="TEXT" name="OEM_CUSTOM_ATTRIBUTE" value=""/>
    <elementParameter field="TEXT" name="HADOOP_APP_PATH" value=""/>
    <elementParameter field="TEXT" name="JOBID_FOR_OOZIE" value=""/>
    <elementParameter field="CHECK" name="IMPLICIT_TCONTEXTLOAD" value="true"/>
    <elementParameter field="RADIO" name="FROM_FILE_FLAG_IMPLICIT_CONTEXT" value="true"/>
    <elementParameter field="FILE" name="IMPLICIT_TCONTEXTLOAD_FILE" value="context.paramFile"/>
    <elementParameter field="TEXT" name="FIELDSEPARATOR" value="&quot;=>&quot;"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION_IMPLICIT_CONTEXT" value=""/>
    <elementParameter field="CHECK" name="DISABLE_INFO" value="false"/>
    <elementParameter field="CHECK" name="ON_STATCATCHER_FLAG" value="true"/>
    <elementParameter field="CHECK" name="ON_LOGCATCHER_FLAG" value="true"/>
    <elementParameter field="CHECK" name="ON_FILES_FLAG" value="true"/>
    <elementParameter field="DIRECTORY" name="FILE_PATH" value="context.logDir"/>
    <elementParameter field="TEXT" name="FILENAME_STATS" value="&quot;stats_file.log&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_LOGS" value="&quot;logs_file.log&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="ojdbc14-10g.jar"/>
    <routinesParameter id="_CtmWkEKREeO8W7a6ZFHFqQ" name="DataOperation"/>
    <routinesParameter id="_Ctr2IEKREeO8W7a6ZFHFqQ" name="GeoOperation"/>
    <routinesParameter id="_CtwHkEKREeO8W7a6ZFHFqQ" name="GeometryOperation"/>
    <routinesParameter id="_CtqA8EKREeO8W7a6ZFHFqQ" name="GeometryUtility"/>
    <routinesParameter id="_Cs2vsEKREeO8W7a6ZFHFqQ" name="Mathematical"/>
    <routinesParameter id="_CtfB0EKREeO8W7a6ZFHFqQ" name="Numeric"/>
    <routinesParameter id="_CtuSYEKREeO8W7a6ZFHFqQ" name="OpenStreetMap"/>
    <routinesParameter id="_CtheEEKREeO8W7a6ZFHFqQ" name="Relational"/>
    <routinesParameter id="_CtoLwEKREeO8W7a6ZFHFqQ" name="StringHandling"/>
    <routinesParameter id="_CtisMEKREeO8W7a6ZFHFqQ" name="TalendDataGenerator"/>
    <routinesParameter id="_CtgP8EKREeO8W7a6ZFHFqQ" name="TalendDate"/>
    <routinesParameter id="_Ctj6UEKREeO8W7a6ZFHFqQ" name="TalendString"/>
    <routinesParameter id="_BzxlsElWEeK5TPMSOHM6dA" name="ArgoUtils"/>
    <routinesParameter id="_cRn34BQsEeKRFb0vPU_LNg" name="DAPUtils"/>
    <routinesParameter id="_IMfY4Dp8EeKYTu4DLH4cKg" name="NetCDFUtils"/>
  </parameters>
  <node componentName="tRunJob" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="160" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tRunJob_1"/>
    <elementParameter field="CHECK" name="START" value="true"/>
    <elementParameter field="CHECK" name="USE_DYNAMIC_JOB" value="false"/>
    <elementParameter field="TEXT" name="CONTEXT_JOB" value=""/>
    <elementParameter field="PROCESS_TYPE" name="PROCESS" value="HarvestMetadataFromFileSystem"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_PROCESS" value="_QdCHMCTmEeOTa_OfsPeSzA"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_VERSION" value="Latest"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_CONTEXT" value="Default"/>
    <elementParameter field="TEXT" name="CONTEXT_NAME" value="Default"/>
    <elementParameter field="CHECK" name="USE_INDEPENDENT_PROCESS" value="false"/>
    <elementParameter field="CHECK" name="DIE_ON_CHILD_ERROR" value="true"/>
    <elementParameter field="CHECK" name="TRANSMIT_WHOLE_CONTEXT" value="true"/>
    <elementParameter field="TABLE" name="CONTEXTPARAMS"/>
    <elementParameter field="CHECK" name="PRINT_PARAMETER" value="false"/>
    <elementParameter field="CHECK" name="TRANSMIT_ORIGINAL_CONTEXT" value="true"/>
    <elementParameter field="TEXT" name="LABEL" value="__PROCESS__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
    <metadata connector="FLOW" name="tRunJob_1"/>
  </node>
  <node componentName="iDeletedResources" componentVersion="0.1" offsetLabelX="0" offsetLabelY="0" posX="544" posY="480">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iDeletedResources_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" value="_-CdwkAuPEeO-v4jR06LTxA"/>
    <elementParameter field="TEXT" name="HOST" value="context.Destination_Server"/>
    <elementParameter field="TEXT" name="TYPE" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Destination_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Destination_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Destination_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Destination_Login"/>
    <elementParameter field="TEXT" name="PASS" value="context.Destination_Password"/>
    <elementParameter field="TEXT" name="JOBNAME" value="&quot;index&quot;"/>
    <elementParameter field="TEXT" name="HARVEST_TYPE" value="&quot;data&quot;"/>
    <elementParameter field="RADIO" name="USE_DEFAULT" value="true"/>
    <elementParameter field="RADIO" name="USE_FILTER" value="false"/>
    <elementParameter field="TEXT" name="FILTER" value="&quot;%&quot;"/>
    <elementParameter field="RADIO" name="USE_CUSTOM_QUERY" value="false"/>
    <elementParameter field="MEMO" name="CUSTOM_QUERY" value="&quot;select id, url, modified &quot; +&#xA;&quot;  from deleted_resource &quot; +&#xA;&quot; where job_name = ? &quot; +&#xA;&quot;   and harvest_type = ? &quot;&#xA;      "/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
  </node>
  <node componentName="tPostgresqlRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="736" posY="480">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tPostgresqlRow_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" value="_-CdwkAuPEeO-v4jR06LTxA"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value=""/>
    <elementParameter field="TEXT" name="HOST" value="context.Destination_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Destination_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Destination_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Destination_Schema"/>
    <elementParameter field="TEXT" name="TYPE" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="USER" value="context.Destination_Login"/>
    <elementParameter field="TEXT" name="PASS" value="context.Destination_Password"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot; SELECT clean_data(&quot; + ((Long)globalMap.get(&quot;iDeletedResources_1_FILE_ID&quot;)).intValue() + &quot;) ;&#xA;DELETE FROM deployments where file_id = &quot; + ((Long)globalMap.get(&quot;iDeletedResources_1_FILE_ID&quot;)).intValue() + &quot; ;&#xA;DELETE FROM indexed_file where id = &quot; + ((Long)globalMap.get(&quot;iDeletedResources_1_FILE_ID&quot;)).intValue() + &quot; ;&#xA;DELETE FROM file_harvest where id = &quot; + ((Long)globalMap.get(&quot;iDeletedResources_1_FILE_ID&quot;)).intValue() + &quot; ; &quot;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
    <metadata connector="FLOW" name="tPostgresqlRow_1"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String"/>
    </metadata>
  </node>
  <node componentName="iPostgresqlDbUpdate" componentVersion="0.1" offsetLabelX="0" offsetLabelY="0" posX="384" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iPostgresqlDbUpdate_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" value="_-CdwkAuPEeO-v4jR06LTxA"/>
    <elementParameter field="TEXT" name="HOST" value="context.Destination_Server"/>
    <elementParameter field="TEXT" name="TYPE" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Destination_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Destination_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Destination_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Destination_Login"/>
    <elementParameter field="TEXT" name="PASS" value="context.Destination_Password"/>
    <elementParameter field="FILE" name="FILENAME" value="&quot;/media/Laurent_emII/TOS_DI-r96646-V5.1.3/workspace_sdi/changelog.xml&quot;"/>
    <elementParameter field="CHECK" name="USE_INLINE_CONTENT" value="true"/>
    <elementParameter field="MEMO" name="INLINE_CONTENT" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?>&#xA;&lt;databaseChangeLog xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd&quot;>&#xA; &#xA;    &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-1&quot;>&#xA;       &lt;sql>&#xA;       CREATE TABLE deployments&#xA;(&#xA;  deploy_id bigserial,&#xA;  file_id integer NOT NULL,&#xA;  time_coverage_start character varying(100),&#xA;  time_coverage_end character varying(100),&#xA;  platform_code character varying(100),&#xA;  file_version character varying(500),&#xA;  aims_channel_id integer,&#xA;  trip_id integer,&#xA;  metadata_uuid character varying(100),&#xA;  cdm_data_type character varying(100),&#xA;  institution character varying(100),&#xA;  data_centre_email character varying(100),&#xA;  principal_investigator_email character varying(100),&#xA;  source character varying(100),&#xA;  project character varying(100),&#xA;  geospatial_vertical_min character varying(100),&#xA;  netcdf_version character varying(100),&#xA;  local_time_zone character varying(100),&#xA;  geospatial_vertical_max character varying(100),&#xA;  data_centre character varying(100),&#xA;  naming_authority character varying(100),&#xA;  author character varying(100),&#xA;  date_created character varying(100),&#xA;  title character varying(100),&#xA;  &quot;references&quot; character varying(100),&#xA;  vessel_name character varying(100),&#xA;  principal_investigator character varying(100),&#xA;  CONSTRAINT deployments_pkey PRIMARY KEY (deploy_id ),&#xA;  CONSTRAINT fk_file_id FOREIGN KEY (file_id)&#xA;      REFERENCES indexed_file (id) MATCH SIMPLE&#xA;      ON UPDATE CASCADE ON DELETE CASCADE&#xA;)&#xA;&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;   &#xA;&#xA;    &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-2&quot;>&#xA;       &lt;sql>&#xA;       CREATE TABLE measurements_fluo&#xA;(&#xA;  file_id integer,&#xA;  measurement bigserial,&#xA;  &quot;TIME&quot; timestamp with time zone,&#xA;  &quot;LATITUDE&quot; double precision,&#xA;  &quot;LATITUDE_quality_control&quot; character(1),&#xA;  &quot;LONGITUDE&quot; double precision,&#xA;  &quot;LONGITUDE_quality_control&quot; character(1),&#xA;  geom geometry,&#xA;  fluorescence real,&#xA;  fluorescence_quality_control character(1),&#xA;  trip_id integer,&#xA;  CONSTRAINT measurements_fluo_pkey PRIMARY KEY (measurement ),&#xA;  CONSTRAINT fk_file_id FOREIGN KEY (file_id)&#xA;      REFERENCES indexed_file (id) MATCH SIMPLE&#xA;      ON UPDATE CASCADE ON DELETE CASCADE&#xA;&#xA;)&#xA;      &lt;/sql>&#xA;    &lt;/changeSet>&#xA;&#xA;    &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-3&quot;>&#xA;       &lt;sql>&#xA;       CREATE TABLE measurements_psal&#xA;(&#xA;  file_id integer,&#xA;  measurement bigserial,&#xA;  &quot;TIME&quot; timestamp with time zone,&#xA;  &quot;LATITUDE&quot; double precision,&#xA;  &quot;LATITUDE_quality_control&quot; character(1),&#xA;  &quot;LONGITUDE&quot; double precision,&#xA;  &quot;LONGITUDE_quality_control&quot; character(1),&#xA;  geom geometry,&#xA;  &quot;PSAL&quot; real,&#xA;  &quot;PSAL_quality_control&quot; character(1),&#xA;  trip_id  smallint,&#xA;  CONSTRAINT measurements_psal_pkey PRIMARY KEY (measurement ),&#xA;  CONSTRAINT fk_file_id FOREIGN KEY (file_id)&#xA;      REFERENCES indexed_file (id) MATCH SIMPLE&#xA;      ON UPDATE CASCADE ON DELETE CASCADE&#xA;)&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;&#xA;    &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-4&quot;>&#xA;       &lt;sql>&#xA;       CREATE TABLE measurements_temp&#xA;(&#xA;  file_id integer,&#xA;  measurement bigserial,&#xA;  &quot;TIME&quot; timestamp with time zone,&#xA;  &quot;LATITUDE&quot; double precision,&#xA;  &quot;LATITUDE_quality_control&quot; character(1),&#xA;  &quot;LONGITUDE&quot; double precision,&#xA;  &quot;LONGITUDE_quality_control&quot; character(1),&#xA;  geom geometry,&#xA;  &quot;Seawater_Intake_Temperature&quot; real,&#xA;  &quot;Seawater_Intake_Temperature_quality_control&quot; character(1),&#xA;  trip_id integer,&#xA;  CONSTRAINT measurements_temp_pkey PRIMARY KEY (measurement ),&#xA;  CONSTRAINT fk_file_id FOREIGN KEY (file_id)&#xA;      REFERENCES indexed_file (id) MATCH SIMPLE&#xA;      ON UPDATE CASCADE ON DELETE CASCADE&#xA;)&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;&#xA;    &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-5&quot;>&#xA;       &lt;sql>&#xA;       CREATE TABLE measurements_turb&#xA;(&#xA;  file_id integer,&#xA;  measurement bigserial,&#xA;  &quot;TIME&quot; timestamp with time zone,&#xA;  &quot;LATITUDE&quot; double precision,&#xA;  &quot;LATITUDE_quality_control&quot; character(1),&#xA;  &quot;LONGITUDE&quot; double precision,&#xA;  &quot;LONGITUDE_quality_control&quot; character(1),&#xA;  geom geometry,&#xA;  &quot;TURB&quot; real,&#xA;  &quot;TURB_quality_control&quot; character(1),&#xA;  trip_id integer,&#xA;  CONSTRAINT measurements_turb_pkey PRIMARY KEY (measurement ),&#xA;  CONSTRAINT fk_file_id FOREIGN KEY (file_id)&#xA;      REFERENCES indexed_file (id) MATCH SIMPLE&#xA;      ON UPDATE CASCADE ON DELETE CASCADE&#xA;)&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-6&quot;>&#xA;       &lt;sql>&#xA;ALTER TABLE measurements_fluo&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX measurements_fluo_gist_idx ON measurements_fluo USING GIST (geom); &#xA; &lt;/sql>&#xA;        &lt;sql>&#xA;ALTER TABLE measurements_psal&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX measurements_psal_gist_idx ON measurements_psal USING GIST (geom); &#xA;&#x9;&lt;/sql>&#xA;        &lt;sql>&#xA;ALTER TABLE measurements_temp&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX measurements_temp_gist_idx ON measurements_temp USING GIST (geom); &#xA;&#x9;&lt;/sql>&#xA;        &lt;sql>&#xA;ALTER TABLE measurements_turb&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX measurements_turb_gist_idx ON measurements_turb USING GIST (geom); &#xA;&#x9;&lt;/sql>&#xA;    &lt;/changeSet>&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-7&quot;>&#xA;       &lt;sql>&#xA;ALTER TABLE measurements_fluo ADD CHECK (ST_IsValid(geom));&#xA;ALTER TABLE measurements_psal ADD CHECK (ST_IsValid(geom));&#xA;ALTER TABLE measurements_temp ADD CHECK (ST_IsValid(geom));&#xA;ALTER TABLE measurements_turb ADD CHECK (ST_IsValid(geom));&#xA;&#x9;&lt;/sql>&#xA;&lt;/changeSet>&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-8&quot;>&#xA;       &lt;sql>&#xA;ALTER TABLE measurements_psal ALTER COLUMN trip_id TYPE integer;&#xA;&#x9;&lt;/sql>&#xA;&lt;/changeSet>&#xA;&#xA;&#xA;&#xA; &#xA;       &lt;changeSet author=&quot;talend&quot; id=&quot;createTable_measurements_merged_data&quot;>&#xA;       &lt;sql>&#xA;       CREATE TABLE measurements_merged_data&#xA;(&#xA;  trip_id integer,&#xA;  &quot;TIME&quot; timestamp with time zone,&#xA;  &quot;LATITUDE&quot; double precision,&#xA;  &quot;LONGITUDE&quot; double precision,&#xA;  geom geometry,&#xA;  &quot;TURB&quot; real,&#xA;  &quot;Seawater_Intake_Temperature&quot; real,&#xA;  fluorescence real,&#xA;  &quot;PSAL&quot; real&#xA;)&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;   &#xA;    &lt;changeSet author=&quot;talend&quot; id=&quot;create-measurements_merged_data_trip_id_idx&quot;>&#xA;       &lt;sql>&#xA;           CREATE INDEX measurements_merged_data_trip_id_idx&#xA;                     ON measurements_merged_data&#xA;                  USING btree&#xA;                ( trip_id, &quot;TIME&quot; );&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;createTableMaster&quot;>&#xA;        &lt;sql>&#xA;CREATE TABLE table_master&#xA;(&#xA;trip_id integer,&#xA;  &quot;TIME&quot; timestamp with time zone,&#xA;  &quot;LATITUDE&quot; double precision,&#xA;  &quot;LONGITUDE&quot; double precision,&#xA;  geom geometry&#xA;)&#xA;  ;&#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-9&quot;>&#xA;        &lt;sql>&#xA;CREATE INDEX measurements_idx&#xA;  ON measurements_merged_data&#xA;  USING btree&#xA;  (&quot;TIME&quot; );&#xA;&#x9;&lt;/sql>&#xA;&#xA;        &lt;sql>&#xA;ALTER TABLE measurements_merged_data&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX measurements_merged_data_gist_idx ON measurements_merged_data USING GIST (geom); &#xA;&#x9;&lt;/sql>&#xA;&#xA;        &lt;sql>&#xA;ALTER TABLE table_master&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX table_master_gist_idx ON table_master USING GIST (geom); &#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-10&quot;>&#xA;        &lt;sql>&#xA;ALTER TABLE measurements_merged_data ADD CHECK (ST_IsValid(geom));&#xA;ALTER TABLE table_master ADD CHECK (ST_IsValid(geom));&#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-11&quot;>&#xA;        &lt;sql>&#xA;ALTER TABLE table_master add column measurements bigserial;&#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;1382580250154-12&quot;>&#xA;        &lt;sql>&#xA;CREATE TABLE temporary_sub_select_wms&#xA;(&#xA;  trip_id integer,&#xA;  time_start timestamp with time zone,&#xA;  time_end timestamp with time zone,&#xA;  &quot;TURB&quot; bigint,&#xA;  &quot;Seawater_Intake_Temperature&quot; bigint,&#xA;  fluorescence bigint,&#xA;  &quot;PSAL&quot; bigint,&#xA;  geom geometry,&#xA;  CONSTRAINT temporary_sub_select_wms_geom_check CHECK (st_isvalid(geom)))&#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250144-1&quot;>&#xA;       &lt;sql>&#xA; CREATE TABLE vessel_names&#xA;(&#xA;  vessel_name character varying(50) NOT NULL,&#xA;  platform_code character varying(50),&#xA;  colour character varying(50),&#xA;  CONSTRAINT vessel_names_pkey PRIMARY KEY (vessel_name )&#xA;)&#xA;       &lt;/sql>&#xA;    &lt;/changeSet>&#xA;   &#xA;&#xA; &lt;changeSet author=&quot;talend&quot; id=&quot;1382580250144-2&quot;>&#xA;        &lt;sql>&#xA;CREATE TABLE visualisation_wms&#xA;(&#xA;  trip_id integer,&#xA;   metadata_uuid character varying(100),&#xA;  time_start timestamp with time zone,&#xA;  time_end timestamp with time zone,&#xA;  vessel_name character varying(50),&#xA;  colour character varying(50),&#xA;  &quot;TURB_b&quot; boolean,&#xA;  &quot;Seawater_Intake_Temperature_b&quot; boolean,&#xA;  fluorescence_b boolean,&#xA;  &quot;PSAL_b&quot; boolean,&#xA;  geom geometry,&#xA;  CONSTRAINT visualisation_wms_geom_check CHECK (st_isvalid(geom)))&#xA;&#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;1382580250144-3&quot;>&#xA;        &lt;sql>&#xA;ALTER TABLE visualisation_wms&#xA;ALTER COLUMN geom TYPE geometry(GEOMETRY, 4326)&#xA;USING ST_SetSRID(geom,4326);&#xA;CREATE INDEX visualisation_wms_gist_idx ON visualisation_wms USING GIST (geom); &#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;1382580250144-4&quot;>&#xA;        &lt;sql>&#xA;CREATE INDEX measurements_merged_data_trip_idx  ON measurements_merged_data  USING btree  (trip_id );&#xA;CREATE INDEX measurements_merged_data_trip_time_idx  ON measurements_merged_data  USING btree  (trip_id ,&quot;TIME&quot;);&#xA;CREATE INDEX visualisation_wms_trip_idx  ON soop_trv.visualisation_wms  USING btree  (trip_id );&#xA;&#xA;ALTER TABLE visualisation_wms ADD CONSTRAINT visualisation_wms_pkey PRIMARY KEY (trip_id );&#xA;ALTER TABLE measurements_merged_data ADD COLUMN measurement bigserial;&#xA;ALTER TABLE measurements_merged_data ADD CONSTRAINT measurements_merged_data_pkey PRIMARY KEY (measurement );&#xA;&#x9;&lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;map_view&quot; runOnChange=&quot;true&quot;>&#xA;        &lt;sql>&#xA;           DROP VIEW IF EXISTS soop_trv_trajectory_map;&#xA;           CREATE VIEW soop_trv_trajectory_map AS &#xA; SELECT a.trip_id, a.metadata_uuid, timezone('UTC'::text, a.time_start) AS time_start, timezone('UTC'::text, a.time_end) AS time_end,  a.colour, a.&quot;TURB_b&quot;, a.fluorescence_b, a.&quot;Seawater_Intake_Temperature_b&quot;, a.&quot;PSAL_b&quot;, a.geom, ( SELECT DISTINCT deployments.platform_code&#xA;           FROM deployments&#xA;          WHERE deployments.trip_id = a.trip_id) AS platform_code, ( SELECT DISTINCT deployments.vessel_name&#xA;           FROM deployments&#xA;          WHERE deployments.trip_id = a.trip_id) AS vessel_name&#xA;   FROM visualisation_wms a;&#xA;    &lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;data_view&quot; runOnChange=&quot;true&quot;>&#xA;        &lt;sql>&#xA;           DROP VIEW IF EXISTS soop_trv_trajectory_data;&#xA;CREATE OR REPLACE VIEW soop_trv_trajectory_data AS &#xA;SELECT measurements_merged_data.trip_id, &#xA;visualisation_wms.vessel_name,&#xA;timezone('UTC'::text, measurements_merged_data.&quot;TIME&quot;) AS &quot;TIME&quot;, &#xA;measurements_merged_data.&quot;LATITUDE&quot;, &#xA;measurements_merged_data.&quot;LONGITUDE&quot;, &#xA;measurements_merged_data.&quot;TURB&quot;, &#xA;measurements_merged_data.&quot;Seawater_Intake_Temperature&quot;, &#xA;measurements_merged_data.&quot;PSAL&quot;, &#xA;measurements_merged_data.fluorescence, &#xA;measurements_merged_data.&quot;TURB&quot; IS NOT NULL AS &quot;TURB_b&quot;, &#xA;measurements_merged_data.&quot;Seawater_Intake_Temperature&quot; IS NOT NULL AS &quot;Seawater_Intake_Temperature_b&quot;,&#xA;measurements_merged_data.&quot;PSAL&quot; IS NOT NULL AS &quot;PSAL_b&quot;,&#xA;measurements_merged_data.fluorescence IS NOT NULL AS fluoroescence_b, &#xA;measurements_merged_data.geom&#xA;   FROM measurements_merged_data&#xA;   JOIN visualisation_wms ON visualisation_wms.trip_id = measurements_merged_data.trip_id&#xA;  ORDER BY trip_id, measurements_merged_data.&quot;TIME&quot;;&#xA;&#xA;    &lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;createIndexOnMeasurementTables&quot; runOnChange=&quot;true&quot;>&#xA;        &lt;sql>&#xA;CREATE INDEX measurements_fluo_trip_id_idx&#xA;  ON soop_trv.measurements_fluo&#xA;  USING btree&#xA;  (trip_id, &quot;TIME&quot;);&#xA;&#xA;CREATE INDEX measurements_psal_trip_id_idx&#xA;  ON soop_trv.measurements_psal&#xA;  USING btree&#xA;  (trip_id, &quot;TIME&quot;);&#xA;&#xA;CREATE INDEX measurements_temp_trip_id_idx&#xA;  ON soop_trv.measurements_temp&#xA;  USING btree&#xA;  (trip_id, &quot;TIME&quot;);&#xA;&#xA;CREATE INDEX measurements_turb_trip_id_idx&#xA;  ON soop_trv.measurements_turb&#xA;  USING btree&#xA;  (trip_id, &quot;TIME&quot;);&#xA;&#xA;CREATE INDEX table_master_trip_id_idx&#xA;  ON soop_trv.table_master&#xA;  USING btree&#xA;  (trip_id, &quot;TIME&quot;);&#xA;    &lt;/sql>&#xA; &lt;/changeSet>&#xA;&#xA;&#xA;&#xA;&lt;changeSet author=&quot;talend&quot; id=&quot;clean_dataFUNCTION&quot; runOnChange=&quot;true&quot; >&#xA;&lt;createProcedure>&#xA;CREATE OR REPLACE FUNCTION clean_data(p_file_id int)&#xA;   RETURNS void AS&#xA;   $BODY$&#xA;  declare&#xA;     v_url text;&#xA;     v_trip_id int;&#xA;  BEGIN&#xA;     select url into v_url from indexed_file where id = $1;&#xA;     select distinct trip_id into v_trip_id from deployments where &#xA;file_id = $1;&#xA;&#xA;     IF v_url ~ 'IMOS_SOOP-TRV_B' THEN&#xA;           delete from  measurements_fluo  where file_id = $1;&#xA;           update measurements_merged_data set fluorescence = NULL where  measurements_merged_data.trip_id = v_trip_id ;&#xA;&#x9;   update  visualisation_wms set fluorescence_b = false WHERE visualisation_wms.trip_id = v_trip_id ;&#xA;&#xA;     ELSIF v_url ~ 'IMOS_SOOP-TRV_S' THEN&#xA;            delete from  measurements_psal  where file_id = $1;&#xA;            update measurements_merged_data set &quot;PSAL&quot; = NULL where measurements_merged_data.trip_id = v_trip_id ;&#xA;    &#x9;    update  visualisation_wms set &quot;PSAL_b&quot; = false WHERE visualisation_wms.trip_id = v_trip_id ;&#xA;&#xA;     ELSIF v_url ~ 'IMOS_SOOP-TRV_T' THEN&#xA;          delete from  measurements_temp  where file_id = $1;&#xA;          update measurements_merged_data set &quot;Seawater_Intake_Temperature&quot; = NULL where measurements_merged_data.trip_id = v_trip_id;&#xA;          update  visualisation_wms set &quot;Seawater_Intake_Temperature_b&quot; = false WHERE visualisation_wms.trip_id = v_trip_id ;&#xA;&#xA;     ELSIF v_url ~ 'IMOS_SOOP-TRV_U' THEN&#xA;          delete from  measurements_turb  where file_id = $1;&#xA;          update measurements_merged_data set &quot;TURB&quot; = NULL where measurements_merged_data.trip_id = v_trip_id ;&#xA;          update  visualisation_wms set &quot;TURB_b&quot; = false WHERE visualisation_wms.trip_id = v_trip_id ;&#xA;&#xA;     END IF;&#xA;    &#xA;     DELETE FROM measurements_merged_data where &quot;TURB&quot;  IS NULL  AND   &quot;Seawater_Intake_Temperature&quot;   IS NULL AND  fluorescence   IS NULL AND  &quot;PSAL&quot;  IS NULL and trip_id = v_trip_id ;&#xA;&#x9;&#xA;  END;&#xA;&#xA;$BODY$&#xA;  LANGUAGE plpgsql &#xA;&lt;/createProcedure>&#xA; &lt;/changeSet>&#xA;&#xA;&lt;/databaseChangeLog>&#xA;"/>
    <elementParameter field="TEXT" name="LABEL" value="liquidBade_createTables"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
  </node>
  <node componentName="tPostgresqlRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="480">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tPostgresqlRow_2"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" value="_-CdwkAuPEeO-v4jR06LTxA"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value=""/>
    <elementParameter field="TEXT" name="HOST" value="context.Destination_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Destination_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Destination_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Destination_Schema"/>
    <elementParameter field="TEXT" name="TYPE" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="USER" value="context.Destination_Login"/>
    <elementParameter field="TEXT" name="PASS" value="context.Destination_Password"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;DELETE FROM visualisation_wms where \&quot;TURB_b\&quot; = FALSE AND   \&quot;Seawater_Intake_Temperature_b\&quot;  = FALSE AND  fluorescence_b  = FALSE AND  \&quot;PSAL_b\&quot;  = FALSE;&quot;&#xA;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
    <metadata connector="FLOW" name="tPostgresqlRow_2"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String"/>
    </metadata>
  </node>
  <node componentName="tPostgresqlRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tPostgresqlRow_3"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" value="_-CdwkAuPEeO-v4jR06LTxA"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="false"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value=""/>
    <elementParameter field="TEXT" name="HOST" value="context.Destination_Server"/>
    <elementParameter field="TEXT" name="PORT" value="context.Destination_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Destination_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Destination_Schema"/>
    <elementParameter field="TEXT" name="TYPE" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="USER" value="context.Destination_Login"/>
    <elementParameter field="TEXT" name="PASS" value="context.Destination_Password"/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;TRUNCATE TABLE table_master;&quot;&#xA;"/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
    <metadata connector="FLOW" name="tPostgresqlRow_3"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" precision="0" sourceType="" type="id_String"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" precision="0" sourceType="" type="id_String"/>
    </metadata>
  </node>
  <node componentName="iHarvestResources" componentVersion="0.1" offsetLabelX="0" offsetLabelY="0" posX="576" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iHarvestResources_1"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" value="_-CdwkAuPEeO-v4jR06LTxA"/>
    <elementParameter field="TEXT" name="HOST" value="context.Destination_Server"/>
    <elementParameter field="TEXT" name="TYPE" value="POSTGRESQL"/>
    <elementParameter field="TEXT" name="PORT" value="context.Destination_Port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.Destination_Database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.Destination_Schema"/>
    <elementParameter field="TEXT" name="USER" value="context.Destination_Login"/>
    <elementParameter field="TEXT" name="PASS" value="context.Destination_Password"/>
    <elementParameter field="TEXT" name="JOBNAME" value="&quot;index&quot;"/>
    <elementParameter field="TEXT" name="HARVEST_TYPE" value="&quot;data&quot;"/>
    <elementParameter field="RADIO" name="USE_DEFAULT" value="true"/>
    <elementParameter field="RADIO" name="USE_FILTER" value="false"/>
    <elementParameter field="TEXT" name="FILTER" value="&quot;%&quot;"/>
    <elementParameter field="RADIO" name="USE_CUSTOM_QUERY" value="false"/>
    <elementParameter field="MEMO" name="CUSTOM_QUERY" value="&quot;select indexed_file.id, indexed_file.url, indexed_file.modified &quot; +&#xA;&quot;  from indexed_file &quot; +&#xA;&quot;  join index_job &quot; +&#xA;&quot;    on indexed_file.job_id = index_job.id &quot; +&#xA;&quot;   and indexed_file.last_indexed_run = index_job.last_run_no &quot; +&#xA;&quot;   and index_job.name = ? &quot; +&#xA;&quot;  left join file_harvest &quot; +&#xA;&quot;    on file_harvest.file_id = indexed_file.id &quot; +&#xA;&quot;   and file_harvest.harvest_type = ? &quot; +&#xA;&quot; where (file_harvest.last_moddate_harvested &lt;> indexed_file.modified &quot; +&#xA;&quot;    or  file_harvest.last_moddate_harvested is null) &quot;;&#xA;      "/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
  </node>
  <node componentName="tRunJob" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="768" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tRunJob_2"/>
    <elementParameter field="CHECK" name="USE_DYNAMIC_JOB" value="false"/>
    <elementParameter field="TEXT" name="CONTEXT_JOB" value=""/>
    <elementParameter field="PROCESS_TYPE" name="PROCESS" value="oneFileProcess"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_PROCESS" value="_XUeoALOwEeOieOMPOJ9pNQ"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_VERSION" value="Latest"/>
    <elementParameter field="TECHNICAL" name="PROCESS:PROCESS_TYPE_CONTEXT" value="Default"/>
    <elementParameter field="TEXT" name="CONTEXT_NAME" value="Default"/>
    <elementParameter field="CHECK" name="USE_INDEPENDENT_PROCESS" value="false"/>
    <elementParameter field="CHECK" name="DIE_ON_CHILD_ERROR" value="true"/>
    <elementParameter field="CHECK" name="TRANSMIT_WHOLE_CONTEXT" value="true"/>
    <elementParameter field="TABLE" name="CONTEXTPARAMS">
      <elementValue elementRef="PARAM_NAME_COLUMN" value="file_id"/>
      <elementValue elementRef="PARAM_VALUE_COLUMN" value="((Long)globalMap.get(&quot;iHarvestResources_1_FILE_ID&quot;)).intValue()"/>
    </elementParameter>
    <elementParameter field="CHECK" name="PRINT_PARAMETER" value="false"/>
    <elementParameter field="CHECK" name="TRANSMIT_ORIGINAL_CONTEXT" value="true"/>
    <elementParameter field="TEXT" name="LABEL" value="__PROCESS__"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <elementParameter field="CHECK" name="INFORMATION" value="false"/>
    <elementParameter field="MEMO" name="COMMENT" value=""/>
    <elementParameter field="CHECK" name="VALIDATION_RULES" value="false"/>
    <metadata connector="FLOW" name="tRunJob_2"/>
  </node>
  <connection connectorName="SUBJOB_OK" label="OnSubjobOk" lineStyle="1" metaname="tRunJob_1" offsetLabelX="0" offsetLabelY="0" source="tRunJob_1" target="iPostgresqlDbUpdate_1">
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnSubjobOk1"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="iDeletedResources_1" offsetLabelX="0" offsetLabelY="0" source="iDeletedResources_1" target="tPostgresqlRow_1">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate2"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tPostgresqlRow_1" offsetLabelX="0" offsetLabelY="0" source="tPostgresqlRow_1" target="tPostgresqlRow_2">
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnComponentOk3"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="iPostgresqlDbUpdate_1" offsetLabelX="0" offsetLabelY="0" outputId="1" source="iPostgresqlDbUpdate_1" target="iDeletedResources_1">
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnComponentOk1"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="iPostgresqlDbUpdate_1" offsetLabelX="0" offsetLabelY="0" outputId="2" source="iPostgresqlDbUpdate_1" target="iHarvestResources_1">
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnComponentOk2"/>
  </connection>
  <connection connectorName="ITERATE" label="Iterate" lineStyle="7" metaname="iHarvestResources_1" offsetLabelX="0" offsetLabelY="0" source="iHarvestResources_1" target="tRunJob_2">
    <elementParameter field="CHECK" name="ENABLE_PARALLEL" value="false"/>
    <elementParameter field="TEXT" name="NUMBER_PARALLEL" value="2"/>
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iterate1"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tRunJob_2" offsetLabelX="0" offsetLabelY="0" source="tRunJob_2" target="tPostgresqlRow_3">
    <elementParameter field="CHECK" name="ACTIVATE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="OnComponentOk4"/>
  </connection>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tRunJob_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iDeletedResources_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iPostgresqlDbUpdate_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tPostgresqlRow_2"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="tPostgresqlRow_3"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
  <subjob>
    <elementParameter field="TEXT" name="UNIQUE_NAME" value="iHarvestResources_1"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="160;190;240"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="220;220;250"/>
  </subjob>
</talendfile:ProcessType>
